{
  "id": "flock",
  "name": "Flock",
  "description": "Agent swarm orchestration â€” homes, leases, state machines, sysadmin protocol, and governance",
  "version": "0.2.0",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "dataDir": {
        "type": "string",
        "description": "Directory for Flock persistent data (SQLite, audit logs). Defaults to {workspaceDir}/.flock"
      },
      "dbBackend": {
        "type": "string",
        "enum": ["memory", "sqlite", "postgres"],
        "description": "Database backend. Default: memory. Use 'sqlite' for persistence."
      },
      "topology": {
        "type": "string",
        "enum": ["peer", "central"],
        "description": "Network topology. 'peer' = P2P, 'central' = all workers on central node. Default: peer"
      },
      "nodeId": {
        "type": "string",
        "description": "This node's identity. Default: 'local'"
      },
      "remoteNodes": {
        "type": "array",
        "description": "Remote Flock nodes to connect to on startup.",
        "items": {
          "type": "object",
          "required": ["nodeId", "a2aEndpoint"],
          "additionalProperties": false,
          "properties": {
            "nodeId": { "type": "string" },
            "a2aEndpoint": { "type": "string" }
          }
        }
      },
      "homes": {
        "type": "object",
        "description": "Home directory configuration",
        "additionalProperties": false,
        "properties": {
          "rootDir": {
            "type": "string",
            "description": "Root directory for agent homes on this node. Defaults to /data/flock-homes"
          },
          "baseDir": {
            "type": "string",
            "description": "Path to the immutable base layer (constitution, policies). Defaults to {dataDir}/base"
          }
        }
      },
      "sysadmin": {
        "type": "object",
        "description": "Sysadmin protocol configuration",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable sysadmin request processing. Default: false"
          },
          "autoGreen": {
            "type": "boolean",
            "description": "Auto-execute Green-classified requests without confirmation. Default: true"
          }
        }
      },
      "economy": {
        "type": "object",
        "description": "Credit economy configuration",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable credit tracking. Default: false"
          },
          "initialBalance": {
            "type": "number",
            "description": "Starting credits for new agents. Default: 1000"
          }
        }
      },
      "testAgents": {
        "type": "array",
        "items": { "type": "string" },
        "description": "Test-only: register echo agents on startup for E2E testing. Default: []"
      },
      "gatewayAgents": {
        "type": "array",
        "description": "Agents backed by gateway sessions. Accepts string IDs or {id, systemPrompt?, role?} objects.",
        "items": {
          "oneOf": [
            { "type": "string" },
            {
              "type": "object",
              "required": ["id"],
              "additionalProperties": false,
              "properties": {
                "id": { "type": "string" },
                "systemPrompt": { "type": "string", "description": "Optional system prompt" },
                "role": { "type": "string", "enum": ["worker", "sysadmin"], "description": "Agent role. Default: worker" }
              }
            }
          ]
        }
      },
      "gateway": {
        "type": "object",
        "description": "Gateway connection settings for routing messages to agent sessions",
        "additionalProperties": false,
        "properties": {
          "port": {
            "type": "number",
            "description": "Gateway HTTP port. Default: 3779"
          },
          "token": {
            "type": "string",
            "description": "Gateway auth token for HTTP calls"
          }
        }
      }
    }
  }
}
